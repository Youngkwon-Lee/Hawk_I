# Implementation Plan - Phase 4: Frontend Integration & API Cleanup

# Goal
Ensure the frontend correctly displays the visual features (Trajectory Maps, Heatmaps) and the VLM-generated Clinical Report. Refactor the backend API (`analyze.py`) to remove redundant computations by leveraging the artifacts already generated by the `VisionAgent`.

## Proposed Changes

### Backend

#### [MODIFY] [analyze.py](file:///c:/Users/YK/tulip/Hawkeye/backend/routes/analyze.py)
- **Remove Redundancy**: Delete the direct calls to `VisualizationService` in `process_video_background`.
- **Use Agent Outputs**: Instead, extract `heatmap_path` and `trajectory_map_path` from `ctx.vision_meta`.
- **Map Paths**: Construct `visualization_urls` using the paths stored in `ctx`.
- **Ensure Persistence**: Verify that the files generated by `VisionAgent` are in the correct `uploads` directory or are accessible via the `/files` route.

### Frontend

#### [VERIFY] [page.tsx](file:///c:/Users/YK/tulip/Hawkeye/frontend/src/app/result/page.tsx)
- Verify that `visualization_urls` are correctly used in the "visualizations" tab.
- Verify that `ai_interpretation` is correctly passed to `AIInterpretation` component.
- Verify that `reasoning_log` is correctly passed to `ReasoningLogViewer`.

## Verification Plan

### Manual Verification
1.  **Start Backend**: Run `app.py`.
2.  **Start Frontend**: Run `npm run dev` in `frontend`.
3.  **End-to-End Test**:
    - Upload a video via the frontend.
    - Wait for analysis.
    - Check the "Visualizations" tab for Heatmap and Trajectory Map.
    - Check the "Dashboard" for the AI Report.
    - Check the "AI Reasoning" tab for the log.
