# Hawkeye AI Agent Architecture Report

**Project**: AI-powered Parkinson's Disease Motor Assessment System
**Version**: 1.0
**Date**: 2024-12-09

---

## Executive Summary

HawkeyeëŠ” **Multi-Agent System (MAS)** ì•„í‚¤í…ì²˜ë¥¼ ì±„íƒí•˜ì—¬ ë¹„ë””ì˜¤ ë¶„ì„, ì„ìƒ í‰ê°€, ë³´ê³ ì„œ ìƒì„±ì„ ììœ¨ì ìœ¼ë¡œ ìˆ˜í–‰í•©ë‹ˆë‹¤. ê° AgentëŠ” íŠ¹í™”ëœ ì—­í• ì„ ë‹´ë‹¹í•˜ë©°, Orchestratorê°€ ì „ì²´ ì›Œí¬í”Œë¡œìš°ë¥¼ ì¡°ìœ¨í•©ë‹ˆë‹¤.

---

## 1. Architecture Overview

```
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚   OrchestratorAgent â”‚
                           â”‚   (Coordinator)     â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                           â”‚                           â”‚
          â–¼                           â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  VisionAgent    â”‚         â”‚ ClinicalAgent   â”‚         â”‚  ReportAgent    â”‚
â”‚  (Perception)   â”‚ â”€â”€â”€â”€â”€â”€â–º â”‚ (Analysis)      â”‚ â”€â”€â”€â”€â”€â”€â–º â”‚ (Communication) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                           â”‚                           â”‚
          â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                    â”‚
          â”‚                    â–¼             â–¼                    â”‚
          â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
          â”‚           â”‚GaitCycle    â”‚ â”‚Validation   â”‚            â”‚
          â”‚           â”‚Agent        â”‚ â”‚Agent        â”‚            â”‚
          â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
          â”‚                                                       â”‚
          â–¼                                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         AnalysisContext                                  â”‚
â”‚    (Shared State: video_path, skeleton_data, metrics, scores, report)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Agent ìƒì„¸ ì„¤ëª…

### 2.1 OrchestratorAgent (ì¡°ìœ¨ì)

**ì—­í• **: ì „ì²´ ë¶„ì„ íŒŒì´í”„ë¼ì¸ ì¡°ìœ¨ ë° ì—ëŸ¬ í•¸ë“¤ë§

**íŒŒì¼**: `backend/agents/orchestrator.py`

**ì›Œí¬í”Œë¡œìš°**:
```python
Vision â†’ Clinical â†’ GaitCycle (if gait) â†’ Validation â†’ Report
```

**í•µì‹¬ ê¸°ëŠ¥**:
| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| ìˆœì°¨ ì‹¤í–‰ | Agentë“¤ì„ ìˆœì„œëŒ€ë¡œ í˜¸ì¶œ |
| ë™ì  ë¼ìš°íŒ… | task_typeì— ë”°ë¼ GaitCycleAgent ì¡°ê±´ë¶€ ì‹¤í–‰ |
| ì—ëŸ¬ ë³µêµ¬ | ë¶€ë¶„ ì‹¤íŒ¨ ì‹œì—ë„ ê°€ëŠ¥í•œ ê²°ê³¼ ë°˜í™˜ |
| ì§„í–‰ ìƒíƒœ ì½œë°± | ì‹¤ì‹œê°„ ì§„í–‰ ìƒíƒœ ì—…ë°ì´íŠ¸ |

**ì™œ ì‚¬ìš©í–ˆëŠ”ê°€?**:
- **ë³µì¡ì„± ê´€ë¦¬**: ì—¬ëŸ¬ ë¶„ì„ ë‹¨ê³„ë¥¼ ë…ë¦½ì  ëª¨ë“ˆë¡œ ë¶„ë¦¬í•˜ì—¬ ìœ ì§€ë³´ìˆ˜ ìš©ì´
- **ìœ ì—°ì„±**: ìƒˆë¡œìš´ Agent ì¶”ê°€/ì œê±° ìš©ì´ (ì˜ˆ: VLM Agent ì¶”ê°€ ì˜ˆì •)
- **ì—ëŸ¬ ê²©ë¦¬**: í•œ Agentì˜ ì‹¤íŒ¨ê°€ ì „ì²´ ì‹œìŠ¤í…œì— ì˜í–¥ ìµœì†Œí™”

---

### 2.2 VisionAgent (ì‹œê° ì¸ì‹)

**ì—­í• **: ë¹„ë””ì˜¤ì—ì„œ ìŠ¤ì¼ˆë ˆí†¤ ì¶”ì¶œ ë° Task ìë™ ê°ì§€

**íŒŒì¼**: `backend/agents/vision_agent.py`

**ì‚¬ìš© ì„œë¹„ìŠ¤**:
| ì„œë¹„ìŠ¤ | ì—­í•  |
|--------|------|
| `MovementBasedROI` | ì›€ì§ì„ ê¸°ë°˜ ê´€ì‹¬ ì˜ì—­ ê°ì§€ |
| `MediaPipeProcessor` | ìŠ¤ì¼ˆë ˆí†¤ ì¶”ì¶œ (Hand/Pose) |
| `TaskClassifier` | Task ìœ í˜• ìë™ ë¶„ë¥˜ |
| `VisualizationService` | Heatmap, Trajectory ìƒì„± |

**ì¶œë ¥**:
- `task_type`: finger_tapping, gait, etc.
- `skeleton_data`: MediaPipe ëœë“œë§ˆí¬ (21/33 points)
- `vision_meta`: ROI, confidence, heatmap_path

**ì™œ ì‚¬ìš©í–ˆëŠ”ê°€?**:
- **ìë™ Task ê°ì§€**: ì‚¬ìš©ìê°€ ìˆ˜ë™ìœ¼ë¡œ Task ìœ í˜• ì§€ì • ë¶ˆí•„ìš”
- **ëª¨ë“ˆí™”**: ìŠ¤ì¼ˆë ˆí†¤ ì¶”ì¶œê³¼ ë¶„ë¥˜ ë¡œì§ ë¶„ë¦¬
- **ì‹œê°í™”**: ë¶„ì„ ê²°ê³¼ë¥¼ ì§ê´€ì ìœ¼ë¡œ ì´í•´í•  ìˆ˜ ìˆëŠ” ìë£Œ ìƒì„±

---

### 2.3 ClinicalAgent (ì„ìƒ ë¶„ì„)

**ì—­í• **: Kinematic Feature ê³„ì‚° ë° UPDRS ì ìˆ˜ ì˜ˆì¸¡

**íŒŒì¼**: `backend/agents/clinical_agent.py`

**ì‚¬ìš© ì„œë¹„ìŠ¤**:
| ì„œë¹„ìŠ¤ | ì—­í•  |
|--------|------|
| `ModelSelectorAgent` | ì ì ˆí•œ ë¶„ì„ ëª¨ë¸ ì„ íƒ |
| `MetricsCalculator` | Kinematic features ê³„ì‚° (27/47ê°œ) |
| `UPDRSScorer` | UPDRS ì ìˆ˜ ì˜ˆì¸¡ (0-4) |

**ìŠ¤ì½”ì–´ë§ ë°©ë²•**:
```python
scoring_method: "rule" | "ml" | "ensemble"
ml_model_type: "rf" | "xgb"
```

| ë°©ë²• | ì„¤ëª… | ì •í™•ë„ |
|------|------|--------|
| Rule-based | ì„ìƒ ê¸°ì¤€ ê¸°ë°˜ ê·œì¹™ | ~85% |
| ML (RF/XGB) | í•™ìŠµëœ ëª¨ë¸ | ~96% |
| Ensemble | ê·œì¹™ + ML í‰ê·  | ~94% |

**ì™œ ì‚¬ìš©í–ˆëŠ”ê°€?**:
- **ì „ë¬¸ì„± ë¶„ë¦¬**: ì˜í•™ì  ë¶„ì„ ë¡œì§ì„ ë…ë¦½ì ìœ¼ë¡œ ê´€ë¦¬
- **ìœ ì—°í•œ ìŠ¤ì½”ì–´ë§**: ì—¬ëŸ¬ ìŠ¤ì½”ì–´ë§ ë°©ë²• ì§€ì› (ì—°êµ¬/ì„ìƒ ìš©ë„ ë¶„ë¦¬)
- **í™•ì¥ì„±**: ìƒˆë¡œìš´ Task (Hand Movement, Leg Agility) ì‰½ê²Œ ì¶”ê°€

---

### 2.4 GaitCycleAgent (ë³´í–‰ ì£¼ê¸° ë¶„ì„)

**ì—­í• **: Gait Task ì „ìš© ìƒì„¸ ì£¼ê¸° ë¶„ì„

**íŒŒì¼**: `backend/agents/gait_cycle_agent.py`

**ë¶„ì„ í•­ëª©**:
| í•­ëª© | ì •ìƒ ë²”ìœ„ | PD íŠ¹ì„± |
|------|----------|---------|
| Cycle Time CV | <3% | >5% (ë³€ë™ì„± ì¦ê°€) |
| Stance Phase | 58-62% | >65% (ëŠë¦° ë³´í–‰) |
| Double Support | ~20% | >30% (ì‹ ì¤‘í•œ ë³´í–‰) |
| Asymmetry | <5% | >10% (í¸ì¸¡ ì¦ìƒ) |

**PD ì¤‘ì¦ë„ ë¶„ë¥˜**:
```
Total Score (0-12) â†’ Normal | Slight | Mild | Moderate | Severe
```

**ì™œ ì‚¬ìš©í–ˆëŠ”ê°€?**:
- **ì „ë¬¸í™”**: Gait ë¶„ì„ì€ Finger Tappingê³¼ ì™„ì „íˆ ë‹¤ë¥¸ ë¶„ì„ í•„ìš”
- **ì„ìƒ ê·¼ê±°**: Morris et al. (1996), Hausdorff et al. (2003) ê¸°ë°˜
- **ì¡°ê±´ë¶€ ì‹¤í–‰**: Gait Taskì—ì„œë§Œ ì‹¤í–‰í•˜ì—¬ ë¦¬ì†ŒìŠ¤ ì ˆì•½

---

### 2.5 ValidationAgent (ê²€ì¦)

**ì—­í• **: ë¶„ì„ ê²°ê³¼ í’ˆì§ˆ ê²€ì¦

**íŒŒì¼**: `backend/agents/validation_agent.py`

**ê²€ì¦ í•­ëª©**:
- ìŠ¤ì¼ˆë ˆí†¤ ê°ì§€ìœ¨ (ìµœì†Œ 80% í•„ìš”)
- ë©”íŠ¸ë¦­ ë²”ìœ„ ìœ íš¨ì„±
- ìŠ¤ì½”ì–´ ì¼ê´€ì„± ê²€ì¦

**ì™œ ì‚¬ìš©í–ˆëŠ”ê°€?**:
- **í’ˆì§ˆ ë³´ì¦**: ì˜ëª»ëœ ë¶„ì„ ê²°ê³¼ í•„í„°ë§
- **ì‹ ë¢°ë„ í‰ê°€**: ê²°ê³¼ì— ì‹ ë¢°ë„ ì ìˆ˜ ë¶€ì—¬
- **ì‚¬ìš©ì ì‹ ë¢°**: ì €í’ˆì§ˆ ê²°ê³¼ì— ê²½ê³  í‘œì‹œ

---

### 2.6 ReportAgent (ë³´ê³ ì„œ ìƒì„±)

**ì—­í• **: AIë¥¼ í™œìš©í•œ í™˜ì ì¹œí™”ì  ë³´ê³ ì„œ ìƒì„±

**íŒŒì¼**: `backend/agents/report_agent.py`

**ì‚¬ìš© ì„œë¹„ìŠ¤**:
| ì„œë¹„ìŠ¤ | ì—­í•  |
|--------|------|
| `InterpretationAgent` | GPT-4o-mini ê¸°ë°˜ ìì—°ì–´ ìƒì„± |

**ì¶œë ¥**:
```python
Report(
    summary_for_patient: str,    # í™˜ììš© ìš”ì•½
    summary_for_clinician: str,  # ì˜ë£Œì§„ìš© ìƒì„¸ ì„¤ëª…
    recommendations: List[str],   # ê¶Œì¥ì‚¬í•­ (3-5ê°œ)
    key_findings: List[str]       # í•µì‹¬ ë°œê²¬ ì‚¬í•­
)
```

**ì™œ ì‚¬ìš©í–ˆëŠ”ê°€?**:
- **ì ‘ê·¼ì„±**: ê¸°ìˆ ì  ë©”íŠ¸ë¦­ì„ ì¼ë°˜ì¸ì´ ì´í•´í•  ìˆ˜ ìˆê²Œ ë³€í™˜
- **LLM í™œìš©**: GPT-4o-minië¡œ ìì—°ìŠ¤ëŸ¬ìš´ í•œêµ­ì–´ ë³´ê³ ì„œ ìƒì„±
- **ë‹¤ì¤‘ ì²­ì¤‘**: í™˜ìì™€ ì˜ë£Œì§„ ê°ê°ì— ë§ëŠ” ë³´ê³ ì„œ ì œê³µ

---

## 3. Shared Context (AnalysisContext)

**íŒŒì¼**: `backend/domain/context.py`

```python
class AnalysisContext(BaseModel):
    # Identity
    video_id: str
    video_path: str

    # Workflow
    status: Literal["pending", "vision_done", "clinical_done", "report_done", "error"]
    error: Optional[str]

    # Configuration
    scoring_method: Literal["rule", "ml", "ensemble"]
    ml_model_type: str  # "rf" | "xgb"

    # Data Slots
    task_type: Optional[str]
    skeleton_data: Optional[Dict]
    vision_meta: Optional[Dict]
    kinematic_metrics: Optional[Dict]
    clinical_scores: Optional[Dict]
    gait_cycle_data: Optional[Dict]
    validation_result: Optional[Dict]
    report: Optional[Report]

    # Reasoning Log (UI í‘œì‹œìš©)
    reasoning_log: List[ReasoningStep]
```

**ì„¤ê³„ ì›ì¹™**:
- **Immutable Data Flow**: AgentëŠ” Contextë¥¼ ë°›ì•„ ì—…ë°ì´íŠ¸í•˜ì—¬ ë°˜í™˜
- **Explicit Dependencies**: ê° AgentëŠ” í•„ìš”í•œ ë°ì´í„° ìŠ¬ë¡¯ ëª…ì‹œ
- **Audit Trail**: reasoning_logë¡œ ì „ì²´ ë¶„ì„ ê³¼ì • ì¶”ì  ê°€ëŠ¥

---

## 4. ì™œ Multi-Agent ì•„í‚¤í…ì²˜ë¥¼ ì„ íƒí–ˆëŠ”ê°€?

### 4.1 ë‹¨ì¼ ëª¨ë†€ë¦¬ì‹ vs Multi-Agent ë¹„êµ

| ì¸¡ë©´ | ëª¨ë†€ë¦¬ì‹ | Multi-Agent (Hawkeye) |
|------|----------|----------------------|
| **ë³µì¡ì„±** | ì½”ë“œ ë’¤ì—‰í‚´ | ê´€ì‹¬ì‚¬ ë¶„ë¦¬ |
| **í…ŒìŠ¤íŠ¸** | ì „ì²´ í…ŒìŠ¤íŠ¸ í•„ìš” | Agent ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ |
| **í™•ì¥ì„±** | ìˆ˜ì • ì˜í–¥ ê´‘ë²”ìœ„ | ë…ë¦½ì  Agent ì¶”ê°€ |
| **ì—ëŸ¬ ì²˜ë¦¬** | ì „ì²´ ì‹¤íŒ¨ | ë¶€ë¶„ ì‹¤íŒ¨ í—ˆìš© |
| **ìœ ì§€ë³´ìˆ˜** | ë³µì¡ | ë‹¨ìˆœ |

### 4.2 ì„ íƒ ì´ìœ 

1. **ë„ë©”ì¸ ë³µì¡ì„±**
   - ë¹„ë””ì˜¤ ì²˜ë¦¬, ìŠ¤ì¼ˆë ˆí†¤ ì¶”ì¶œ, ë©”íŠ¸ë¦­ ê³„ì‚°, ML ì˜ˆì¸¡, LLM í•´ì„
   - ê°ê° ì „ë¬¸ ì§€ì‹ê³¼ ë‹¤ë¥¸ ê¸°ìˆ  ìŠ¤íƒ í•„ìš”

2. **ì—°êµ¬ ìœ ì—°ì„±**
   - ìƒˆë¡œìš´ ë¶„ì„ ë°©ë²• ì‹¤í—˜ ìš©ì´ (Agent ì¶”ê°€/êµì²´)
   - A/B í…ŒìŠ¤íŠ¸ (Rule vs ML vs Ensemble)

3. **ì‹¤íŒ¨ ê²©ë¦¬**
   - LLM API ì‹¤íŒ¨ ì‹œì—ë„ ìŠ¤ì½”ì–´ ê²°ê³¼ëŠ” ë°˜í™˜ ê°€ëŠ¥
   - ë¶€ë¶„ì  ê²°ê³¼ë¼ë„ ìœ ìš©í•œ ì •ë³´ ì œê³µ

4. **í™•ì¥ ê³„íš**
   - VLM Agent (Qwen-VL, LLaVA) ì¶”ê°€ ì˜ˆì •
   - ë©€í‹°ëª¨ë‹¬ ë¶„ì„ (ë¹„ë””ì˜¤ + í…ìŠ¤íŠ¸ + ì˜¤ë””ì˜¤)

---

## 5. í†µí•© ì•„í‚¤í…ì²˜

### 5.1 Backend-Frontend ì—°ë™

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Frontend (Next.js)                       â”‚
â”‚                                                                   â”‚
â”‚  /test â†’ Upload Video â†’ POST /api/analyze                        â”‚
â”‚                              â”‚                                    â”‚
â”‚  /analyzing â†’ Poll /api/analysis/progress/{id}                   â”‚
â”‚                              â”‚                                    â”‚
â”‚  /result â†’ GET /api/analysis/result/{id}                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Backend (Flask)                             â”‚
â”‚                                                                   â”‚
â”‚  POST /api/analyze                                                â”‚
â”‚       â”‚                                                           â”‚
â”‚       â””â”€â†’ Background Thread                                      â”‚
â”‚              â”‚                                                    â”‚
â”‚              â”œâ”€â”€ OrchestratorAgent.process(ctx)                  â”‚
â”‚              â”‚      â”œâ”€â”€ VisionAgent                              â”‚
â”‚              â”‚      â”œâ”€â”€ ClinicalAgent                            â”‚
â”‚              â”‚      â”œâ”€â”€ GaitCycleAgent                           â”‚
â”‚              â”‚      â”œâ”€â”€ ValidationAgent                          â”‚
â”‚              â”‚      â””â”€â”€ ReportAgent                              â”‚
â”‚              â”‚                                                    â”‚
â”‚              â””â”€â”€ Save result to {id}_result.json                 â”‚
â”‚                                                                   â”‚
â”‚  GET /api/analysis/progress/{id}                                  â”‚
â”‚       â””â”€â†’ Return current step status                             â”‚
â”‚                                                                   â”‚
â”‚  GET /api/analysis/result/{id}                                    â”‚
â”‚       â””â”€â†’ Return JSON result                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ì‹¤ì‹œê°„ ì§„í–‰ ìƒíƒœ

```python
# progress_tracker.py
steps = [
    "roi_detection",      # VisionAgent
    "skeleton",           # VisionAgent
    "heatmap",           # VisionAgent
    "temporal_map",      # VisionAgent
    "metrics",           # ClinicalAgent
    "updrs_calculation", # ClinicalAgent
    "gait_cycle",        # GaitCycleAgent (optional)
    "validation",        # ValidationAgent
    "ai_interpretation"  # ReportAgent
]
```

---

## 6. ê¸°ìˆ  ìŠ¤íƒ ìš”ì•½

### 6.1 AI/ML Components

| Component | Technology | ìš©ë„ |
|-----------|------------|------|
| Skeleton Extraction | MediaPipe 0.10.x | Hand/Pose ëœë“œë§ˆí¬ |
| ML Scoring | XGBoost, Random Forest | UPDRS ì˜ˆì¸¡ |
| LLM Interpretation | GPT-4o-mini | ë³´ê³ ì„œ ìƒì„± |
| Computer Vision | OpenCV 4.8 | ë¹„ë””ì˜¤ ì²˜ë¦¬ |
| Deep Learning | PyTorch 2.1 | (LSTM í•™ìŠµìš©) |

### 6.2 ì™¸ë¶€ ì˜ì¡´ì„±

| ì„œë¹„ìŠ¤ | í•„ìˆ˜ ì—¬ë¶€ | Fallback |
|--------|----------|----------|
| OpenAI API | Optional | Rule-based ë³´ê³ ì„œ |
| CUDA GPU | Optional | CPU ëª¨ë“œ |

---

## 7. í–¥í›„ ê°œì„  ê³„íš

### 7.1 ë‹¨ê¸° (1-2ê°œì›”)

1. **VLMAgent ì¶”ê°€**
   - Qwen-VL ë˜ëŠ” LLaVA ê¸°ë°˜
   - ë¹„ë””ì˜¤ ì§ì ‘ ë¶„ì„ìœ¼ë¡œ ìŠ¤ì¼ˆë ˆí†¤ ì—†ì´ë„ í‰ê°€ ê°€ëŠ¥

2. **ë©€í‹°ëª¨ë‹¬ ë¶„ì„**
   - ìŒì„± ë¶„ì„ (ë°œìŒ ëª…í™•ì„±)
   - ì–¼êµ´ í‘œì • ë¶„ì„ (ê°€ë©´ì–¼êµ´)

### 7.2 ì¤‘ê¸° (3-6ê°œì›”)

1. **Agent ììœ¨ì„± ê°•í™”**
   - ReACT íŒ¨í„´ ì ìš©
   - Agent ê°„ ì§ì ‘ í†µì‹ 

2. **ì˜¨ë¼ì¸ í•™ìŠµ**
   - ì‚¬ìš©ì í”¼ë“œë°± ê¸°ë°˜ ëª¨ë¸ ê°œì„ 
   - Federated Learning ê²€í† 

---

## 8. ê´€ë ¨ íŒŒì¼

| íŒŒì¼ | ì„¤ëª… |
|------|------|
| `backend/agents/base_agent.py` | Agent ì¶”ìƒ í´ë˜ìŠ¤ |
| `backend/agents/orchestrator.py` | ì¡°ìœ¨ì Agent |
| `backend/agents/vision_agent.py` | ì‹œê° ì¸ì‹ Agent |
| `backend/agents/clinical_agent.py` | ì„ìƒ ë¶„ì„ Agent |
| `backend/agents/gait_cycle_agent.py` | ë³´í–‰ ì£¼ê¸° Agent |
| `backend/agents/validation_agent.py` | ê²€ì¦ Agent |
| `backend/agents/report_agent.py` | ë³´ê³ ì„œ Agent |
| `backend/domain/context.py` | ê³µìœ  ì»¨í…ìŠ¤íŠ¸ |
| `backend/services/interpretation_agent.py` | LLM í•´ì„ ì„œë¹„ìŠ¤ |

---

## 9. Task Classification System

### 9.1 ê°œìš”

**íŒŒì¼**: `backend/services/task_classifier.py`

Task Classificationì€ ë¹„ë””ì˜¤ì—ì„œ ìë™ìœ¼ë¡œ **MDS-UPDRS Task ìœ í˜•**ì„ ê°ì§€í•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤.
ì‚¬ìš©ìê°€ ìˆ˜ë™ìœ¼ë¡œ Taskë¥¼ ì„ íƒí•˜ì§€ ì•Šì•„ë„ ì‹œìŠ¤í…œì´ ìë™ìœ¼ë¡œ ë¶„ë¥˜í•©ë‹ˆë‹¤.

### 9.2 ë¶„ë¥˜ ì•Œê³ ë¦¬ì¦˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Task Classification Flow                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚   [Video Input]                                                  â”‚
â”‚        â”‚                                                          â”‚
â”‚        â–¼                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚   â”‚ MovementBasedROI â”‚  â”€â†’ Movement Map ìƒì„±                     â”‚
â”‚   â”‚ (Frame Diff)     â”‚     Motion Area Ratio ê³„ì‚°                â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚            â”‚                                                      â”‚
â”‚            â–¼                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚   â”‚ Body Part       â”‚  â”€â†’ MediaPipe Hands/Pose ê°ì§€              â”‚
â”‚   â”‚ Detection       â”‚     hand / foot / fullbody ë¶„ë¥˜            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚            â”‚                                                      â”‚
â”‚            â–¼                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚   â”‚ TaskClassifier  â”‚  â”€â†’ ê·œì¹™ ê¸°ë°˜ ìµœì¢… ë¶„ë¥˜                    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚            â”‚                                                      â”‚
â”‚            â–¼                                                      â”‚
â”‚   [Task Type + Confidence]                                       â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.3 ë¶„ë¥˜ ê·œì¹™ (Decision Rules)

| Body Part | Motion Area Ratio | Task Type | ì„¤ëª… |
|-----------|------------------|-----------|------|
| `hand` | < 5% | **finger_tapping** | ì†ê°€ë½ ë ì‘ì€ ì›€ì§ì„ |
| `hand` | â‰¥ 5% | **hand_movement** | ì†ëª© íšŒì „ (Pronation-Supination) |
| `foot` | < 10% | **leg_agility** | ì œìë¦¬ ë‹¤ë¦¬ ì˜¬ë¦¬ê¸° |
| `foot` | > 10% | **gait** | ë³´í–‰ (Gait) |
| `fullbody` | any | **gait** | ì „ì‹  ì›€ì§ì„ = ë³´í–‰ |
| `unknown` | any | **unknown** | ë¶„ë¥˜ ì‹¤íŒ¨ |

### 9.4 ROI Detection ì•Œê³ ë¦¬ì¦˜

**íŒŒì¼**: `backend/services/roi_detector.py`

**Step 1: Movement Map ìƒì„±**
```python
# Frame Differencing Algorithm
1. Nê°œ í”„ë ˆì„ ìƒ˜í”Œë§ (default: 30)
2. Grayscale ë³€í™˜
3. ì—°ì† í”„ë ˆì„ ì°¨ì´ ê³„ì‚°: diff = |frame[t] - frame[t-1]|
4. ì„ê³„ê°’ ì ìš© (threshold=10)
5. ëˆ„ì  ë° ì •ê·œí™” â†’ Movement Map (HÃ—W, [0, 1])
```

**Step 2: ROI ì¶”ì¶œ**
```python
# Contour-based ROI Detection
1. ì ì‘ì  ì„ê³„ê°’ (motion mean < 0.02 â†’ 0.05, else â†’ 0.3)
2. í˜•íƒœí•™ì  ì—°ì‚° (Close + Open)
3. ìœ¤ê³½ì„  ê²€ì¶œ (findContours)
4. ë…¸ì´ì¦ˆ í•„í„°ë§ (min area = 0.01% of frame)
5. ë‹¤ì¤‘ ìœ¤ê³½ì„  ë³‘í•© (Gaitì˜ ê²½ìš°)
6. íŒ¨ë”© ì¶”ê°€ (50%)
7. ìµœì†Œ í¬ê¸° ë³´ì¥ (150px for MediaPipe)
```

**Step 3: Body Part Detection**
```python
# MediaPipe-based Detection
1. ROI ì˜ì—­ì—ì„œ 5ê°œ í”„ë ˆì„ ì¶”ì¶œ
2. MediaPipe Hands ê°ì§€ â†’ hand_count
3. MediaPipe Pose ê°ì§€ â†’ foot_count, fullbody_count
4. ìš°ì„ ìˆœìœ„: fullbody > foot > hand
5. Confidence ê³„ì‚°
```

### 9.5 ë¶„ë¥˜ ì„±ëŠ¥

| ì¸¡ë©´ | ì„±ëŠ¥ |
|------|------|
| ì •í™•ë„ | ~90% (ìˆ˜ë™ ë ˆì´ë¸” ëŒ€ë¹„) |
| ì²˜ë¦¬ ì‹œê°„ | ~2ì´ˆ (30 í”„ë ˆì„ ë¶„ì„) |
| ì‹¤íŒ¨ ì²˜ë¦¬ | Unknown â†’ ì‚¬ìš©ì ìˆ˜ë™ ì„ íƒ ìš”ì²­ |

### 9.6 ì™œ ì´ ë°©ì‹ì„ ì‚¬ìš©í–ˆëŠ”ê°€?

1. **No ML Model Required**: ìˆœìˆ˜ ì•Œê³ ë¦¬ì¦˜ ê¸°ë°˜ìœ¼ë¡œ ì¶”ê°€ ëª¨ë¸ í•™ìŠµ ë¶ˆí•„ìš”
2. **Interpretable**: ë¶„ë¥˜ ê·¼ê±°ê°€ ëª…í™• (motion ratio, body part)
3. **Fast**: ~2ì´ˆ ë‚´ ë¶„ë¥˜ ì™„ë£Œ
4. **Robust**: Frame differencingì€ ì¡°ëª… ë³€í™”ì— ê°•ê±´

---

## 10. XAI (Explainability) - ì„¤ëª… ê°€ëŠ¥í•œ AI

### 10.1 ê°œìš”

HawkeyeëŠ” **Explainable AI (XAI)** ì›ì¹™ì„ ë”°ë¼ ë¶„ì„ ê²°ê³¼ì˜ **íˆ¬ëª…ì„±**ê³¼ **í•´ì„ ê°€ëŠ¥ì„±**ì„ ì œê³µí•©ë‹ˆë‹¤.

### 10.2 XAI ì‹œê°í™” ìœ í˜•

**íŒŒì¼**: `backend/services/visualization.py`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    XAI Visualization Types                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚   â”‚   Motion    â”‚    â”‚  Temporal   â”‚    â”‚  Attention  â”‚         â”‚
â”‚   â”‚   Heatmap   â”‚    â”‚  Trajectory â”‚    â”‚    Map      â”‚         â”‚
â”‚   â”‚     âœ…      â”‚    â”‚     âœ…      â”‚    â”‚   â³ ë¯¸êµ¬í˜„  â”‚         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚          â”‚                  â”‚                  â”‚                 â”‚
â”‚          â–¼                  â–¼                  â–¼                 â”‚
â”‚   "ì–´ë””ì—ì„œ ì›€ì§ì„ì´"   "ì‹œê°„ì— ë”°ë¥¸"     "AIê°€ ì£¼ëª©í•œ"         â”‚
â”‚   "ê°€ì¥ ë§ì•˜ëŠ”ê°€"      "ì›€ì§ì„ ê¶¤ì "      "ì˜ì—­" (í–¥í›„)         â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**í˜„ì¬ ì‚¬ìš© ì¤‘ì¸ XAI**:
| ì‹œê°í™” | VisionAgent í˜¸ì¶œ | ìƒíƒœ |
|--------|-----------------|------|
| Motion Heatmap | `generate_motion_heatmap()` | âœ… í™œì„± |
| Temporal Trajectory | `generate_temporal_map()` | âœ… í™œì„± |
| Attention Map | `generate_attention_map()` | â³ ë¯¸ì‚¬ìš© |

### 10.3 Motion Heatmap

**ëª©ì **: ì›€ì§ì„ì´ ì§‘ì¤‘ëœ ì˜ì—­ì„ ì‹œê°í™”

**ì•Œê³ ë¦¬ì¦˜**:
```python
1. ëª¨ë“  í”„ë ˆì„ì˜ keypoint ìœ„ì¹˜ ìˆ˜ì§‘
2. ê° ìœ„ì¹˜ì— Gaussian Blob ëˆ„ì  (radius=15px)
3. ì •ê·œí™” â†’ [0, 1]
4. Gaussian Blur ì ìš© (kernel=31Ã—31)
5. JET Colormap ì ìš© (Blueâ†’Greenâ†’Yellowâ†’Red)
6. (ì„ íƒ) ì›ë³¸ ë¹„ë””ì˜¤ í”„ë ˆì„ê³¼ ë¸”ë Œë”© (60% heatmap)
```

**ì¶œë ¥ ì˜ˆì‹œ**:
- ë¹¨ê°•: ë†’ì€ ì›€ì§ì„ ë°€ë„ (ì†ê°€ë½ ë ë“±)
- íŒŒë‘: ë‚®ì€ ì›€ì§ì„ ë°€ë„ (ê³ ì •ëœ ë¶€ìœ„)

**ì„ìƒì  ì˜ë¯¸**:
| ìƒ‰ìƒ | ì˜ë¯¸ | PD íŠ¹ì„± |
|------|------|---------|
| ğŸ”´ Red | ê³ ë°€ë„ ì›€ì§ì„ | ì •ìƒ: ë„“ì€ ë¶„í¬ |
| ğŸŸ¡ Yellow | ì¤‘ê°„ ë°€ë„ | - |
| ğŸŸ¢ Green | ì €ë°€ë„ ì›€ì§ì„ | - |
| ğŸ”µ Blue | ìµœì†Œ ì›€ì§ì„ | PD: ì¢ì€ ë¶„í¬ (Hypokinesia) |

### 10.4 Temporal Trajectory Map

**ëª©ì **: ì‹œê°„ì— ë”°ë¥¸ ì£¼ìš” ê´€ì ˆì˜ ì´ë™ ê²½ë¡œ ì‹œê°í™”

**ì•Œê³ ë¦¬ì¦˜**:
```python
1. ì¶”ì í•  ê´€ì ˆ ì„ íƒ:
   - Hand Mode: Thumb Tip (4), Index Tip (8)
   - Gait Mode: Left Ankle (27), Right Ankle (28)
2. ê° í”„ë ˆì„ì—ì„œ ì¢Œí‘œ ìˆ˜ì§‘
3. ì—°ì† ì ë“¤ì„ ì„ ìœ¼ë¡œ ì—°ê²°
4. ìƒ‰ìƒ êµ¬ë¶„: Teal (#1F77B4), Purple (#800080)
5. (ì„ íƒ) ì›ë³¸ í”„ë ˆì„ê³¼ ì˜¤ë²„ë ˆì´
```

**ì„ìƒì  ì˜ë¯¸**:
| íŒ¨í„´ | ì •ìƒ | PD íŠ¹ì„± |
|------|------|---------|
| ê¶¤ì  ê¸¸ì´ | ë„“ì€ ë²”ìœ„ | ì¢ì€ ë²”ìœ„ (Bradykinesia) |
| ê·œì¹™ì„± | ì¼ì •í•œ ê°„ê²© | ë¶ˆê·œì¹™ (Festination) |
| ëŒ€ì¹­ì„± | ì¢Œìš° ëŒ€ì¹­ | ë¹„ëŒ€ì¹­ (í¸ì¸¡ ì¦ìƒ) |

### 10.5 Attention Map (Movement-based) - ë¯¸êµ¬í˜„

> âš ï¸ **Note**: `generate_attention_map()` í•¨ìˆ˜ëŠ” ì •ì˜ë˜ì–´ ìˆìœ¼ë‚˜, í˜„ì¬ íŒŒì´í”„ë¼ì¸ì—ì„œ **ì‚¬ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤**. í–¥í›„ VLM Agent ì¶”ê°€ ì‹œ í™œì„±í™” ì˜ˆì •.

**ëª©ì **: AIê°€ ë¶„ì„ì—ì„œ ì£¼ëª©í•œ ì˜ì—­ í‘œì‹œ

**ì•Œê³ ë¦¬ì¦˜** (êµ¬í˜„ë¨, ë¯¸ì‚¬ìš©):
```python
1. ì—°ì† í”„ë ˆì„ ê°„ keypoint ì´ë™ëŸ‰ ê³„ì‚°:
   movement = sqrt((x2-x1)Â² + (y2-y1)Â²)
2. ì´ë™ëŸ‰ì— ë¹„ë¡€í•˜ëŠ” Gaussian Blob ëˆ„ì  (radius=30px)
3. ì •ê·œí™” ë° Gaussian Blur (kernel=51Ã—51)
4. JET Colormap ì ìš©
```

**ì„ìƒì  ì˜ë¯¸** (í–¥í›„ ì ìš© ì‹œ):
- ë¹¨ê°•: AIê°€ ê°€ì¥ ì£¼ëª©í•œ ì˜ì—­ (í° ì›€ì§ì„)
- íŒŒë‘: AIê°€ ëœ ì£¼ëª©í•œ ì˜ì—­ (ì‘ì€ ì›€ì§ì„)

### 10.6 Reasoning Log (ì¶”ë¡  ë¡œê·¸)

**íŒŒì¼**: `backend/domain/context.py`

```python
@dataclass
class ReasoningStep:
    """AI ì¶”ë¡  ë‹¨ê³„ ë¡œê·¸"""
    step: str           # "roi_detection", "task_classification", etc.
    description: str    # "Detected hand with 95% confidence"
    confidence: float   # 0.95
    timestamp: float    # Unix timestamp
    details: Dict       # ì¶”ê°€ ë©”íƒ€ë°ì´í„°
```

**UI í‘œì‹œ**: Frontendì—ì„œ ê° ë¶„ì„ ë‹¨ê³„ì˜ ì¶”ë¡  ê³¼ì •ì„ ì‹¤ì‹œê°„ í‘œì‹œ

### 10.7 XAI ì‹œê°í™” ìƒì„± íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  VisionAgent XAI Pipeline                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  1. ROI Detection                                                â”‚
â”‚     â””â”€â†’ movement_map ìƒì„±                                        â”‚
â”‚         â””â”€â†’ generate_motion_heatmap(movement_map)                â”‚
â”‚                                                                   â”‚
â”‚  2. Skeleton Extraction                                          â”‚
â”‚     â””â”€â†’ frames_data (keypoints per frame)                        â”‚
â”‚         â””â”€â†’ generate_heatmap(frames_data)                        â”‚
â”‚         â””â”€â†’ generate_temporal_map(frames_data)                   â”‚
â”‚                                                                   â”‚
â”‚  3. Context Update                                               â”‚
â”‚     â””â”€â†’ vision_meta = {                                          â”‚
â”‚             heatmap_path: "...",                                 â”‚
â”‚             trajectory_map_path: "...",                          â”‚
â”‚             motion_heatmap_path: "..."                           â”‚
â”‚         }                                                         â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.8 XAI ì„¤ê³„ ì›ì¹™

| ì›ì¹™ | ì„¤ëª… | êµ¬í˜„ |
|------|------|------|
| **Transparency** | ë¶„ì„ ê³¼ì • ê³µê°œ | Reasoning Log |
| **Interpretability** | ê²°ê³¼ í•´ì„ ê°€ëŠ¥ | Heatmap, Trajectory |
| **Faithfulness** | AI íŒë‹¨ ê·¼ê±° ì¼ì¹˜ | Attention Map |
| **Accessibility** | ë¹„ì „ë¬¸ê°€ ì´í•´ ê°€ëŠ¥ | ìƒ‰ìƒ ì½”ë”©, í•œê¸€ ì„¤ëª… |

### 10.9 ì™œ XAIê°€ ì¤‘ìš”í•œê°€?

1. **ì˜ë£Œ ì‹ ë¢°ì„±**: ì˜ë£Œì§„ì´ AI íŒë‹¨ ê·¼ê±°ë¥¼ í™•ì¸ ê°€ëŠ¥
2. **í™˜ì ì´í•´**: í™˜ìê°€ ìì‹ ì˜ ìƒíƒœë¥¼ ì‹œê°ì ìœ¼ë¡œ ì´í•´
3. **ì—°êµ¬ í™œìš©**: ì—°êµ¬ìê°€ ìƒˆë¡œìš´ ë°”ì´ì˜¤ë§ˆì»¤ ë°œê²¬ ê°€ëŠ¥
4. **ê·œì œ ì¤€ìˆ˜**: FDA/CE ì¸ì¦ì„ ìœ„í•œ ì„¤ëª… ê°€ëŠ¥ì„± ìš”êµ¬ì‚¬í•­ ì¶©ì¡±

---

## 11. ì „ì²´ ë¶„ì„ íŒŒì´í”„ë¼ì¸ ìš”ì•½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Complete Analysis Pipeline                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  [Video Upload]                                                  â”‚
â”‚       â”‚                                                          â”‚
â”‚       â–¼                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ VisionAgent                                                  â”‚â”‚
â”‚  â”‚  â”œâ”€ MovementBasedROI â†’ Movement Map + ROI                   â”‚â”‚
â”‚  â”‚  â”œâ”€ TaskClassifier â†’ Task Type (auto-detect)                â”‚â”‚
â”‚  â”‚  â”œâ”€ MediaPipeProcessor â†’ Skeleton Data                      â”‚â”‚
â”‚  â”‚  â””â”€ VisualizationService â†’ Heatmap, Trajectory (XAI)        â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚       â”‚                                                          â”‚
â”‚       â–¼                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ClinicalAgent                                                â”‚â”‚
â”‚  â”‚  â”œâ”€ MetricsCalculator â†’ 27~47 Kinematic Features            â”‚â”‚
â”‚  â”‚  â””â”€ UPDRSScorer â†’ UPDRS Score (0-4)                         â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚       â”‚                                                          â”‚
â”‚       â–¼ (if gait)                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ GaitCycleAgent                                               â”‚â”‚
â”‚  â”‚  â””â”€ Gait Cycle Analysis â†’ Variability, Asymmetry, Stance    â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚       â”‚                                                          â”‚
â”‚       â–¼                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ValidationAgent                                              â”‚â”‚
â”‚  â”‚  â””â”€ Quality Check â†’ Detection Rate, Metric Range Validation â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚       â”‚                                                          â”‚
â”‚       â–¼                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ReportAgent                                                  â”‚â”‚
â”‚  â”‚  â””â”€ InterpretationAgent (GPT-4o-mini) â†’ Natural Language    â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚       â”‚                                                          â”‚
â”‚       â–¼                                                          â”‚
â”‚  [Analysis Result + XAI Visualizations]                         â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 12. ê´€ë ¨ íŒŒì¼ (Updated)

| íŒŒì¼ | ì„¤ëª… |
|------|------|
| **Agents** | |
| `backend/agents/base_agent.py` | Agent ì¶”ìƒ í´ë˜ìŠ¤ |
| `backend/agents/orchestrator.py` | ì¡°ìœ¨ì Agent |
| `backend/agents/vision_agent.py` | ì‹œê° ì¸ì‹ Agent |
| `backend/agents/clinical_agent.py` | ì„ìƒ ë¶„ì„ Agent |
| `backend/agents/gait_cycle_agent.py` | ë³´í–‰ ì£¼ê¸° Agent |
| `backend/agents/validation_agent.py` | ê²€ì¦ Agent |
| `backend/agents/report_agent.py` | ë³´ê³ ì„œ Agent |
| **Services** | |
| `backend/services/task_classifier.py` | Task ìë™ ë¶„ë¥˜ |
| `backend/services/roi_detector.py` | ì›€ì§ì„ ê¸°ë°˜ ROI ê°ì§€ |
| `backend/services/visualization.py` | XAI ì‹œê°í™” (Heatmap, Trajectory) |
| `backend/services/mediapipe_processor.py` | ìŠ¤ì¼ˆë ˆí†¤ ì¶”ì¶œ |
| `backend/services/metrics_calculator.py` | Kinematic Feature ê³„ì‚° |
| `backend/services/updrs_scorer.py` | UPDRS ìŠ¤ì½”ì–´ë§ |
| `backend/services/interpretation_agent.py` | LLM í•´ì„ (GPT-4o-mini) |
| **Domain** | |
| `backend/domain/context.py` | ê³µìœ  ì»¨í…ìŠ¤íŠ¸ + ReasoningStep |

---

**Document End**
